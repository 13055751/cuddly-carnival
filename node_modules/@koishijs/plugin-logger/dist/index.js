var Rt=Object.defineProperty;var Nt=(e,a,u)=>a in e?Rt(e,a,{enumerable:true,configurable:true,writable:true,value:u}):e[a]=u;var E=(e,a,u)=>Nt(e,typeof a!="symbol"?a+"":a,u);import{defineComponent as Oe,resolveComponent as ve,openBlock as T,createBlock as be,unref as Q,withCtx as Se,createElementVNode as K,normalizeClass as qt,createVNode as Ee,createCommentVNode as it,inject as zt,computed as Ut,createElementBlock as at,Fragment as Pt}from"vue";import{VirtualList as Wt,store as $,Time as Ht,icons as Ft}from"@koishijs/client";var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function st(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Vt(e){if(e.__esModule)return e;var a=e.default;if(typeof a=="function"){var u=function c(){return this instanceof c?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};u.prototype=a.prototype}else u={};return Object.defineProperty(u,"__esModule",{value:true}),Object.keys(e).forEach(function(c){var y=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(u,c,y.get?y:{enumerable:true,get:function(){return e[c]}})}),u}var de,Ke;function Tt(){if(Ke)return de;Ke=1;function e(){const u=/(Chrome|Chromium)\/(?<chromeVersion>\d+)\./.exec(navigator.userAgent);if(u)return Number.parseInt(u.groups.chromeVersion,10)}const a=e()>=69?{level:1,hasBasic:true,has256:false,has16m:false}:false;return de={stdout:a,stderr:a},de}var je=Tt(),Gt=Object.defineProperty,m=(e,a)=>Gt(e,"name",{value:a,configurable:true});function Jt(){}m(Jt,"noop");function j(e){return e==null}m(j,"isNullable");function Yt(e){return e&&typeof e=="object"&&!Array.isArray(e)}m(Yt,"isPlainObject");function Zt(e,a){return Object.fromEntries(Object.entries(e).filter(([u,c])=>a(u,c)))}m(Zt,"filterKeys");function lt(e,a){return Object.fromEntries(Object.entries(e).map(([u,c])=>[u,a(c,u)]))}m(lt,"mapValues");function Xt(e,a,u){if(!a)return{...e};const c={};for(const y of a)(u||e[y]!==void 0)&&(c[y]=e[y]);return c}m(Xt,"pick");function Qt(e,a){if(!a)return{...e};const u={...e};for(const c of a)Reflect.deleteProperty(u,c);return u}m(Qt,"omit");function Kt(e,a,u){return Object.defineProperty(e,a,{writable:true,value:u,enumerable:false})}m(Kt,"defineProperty");function jt(e,a){return a.every(u=>e.includes(u))}m(jt,"contain");function er(e,a){return e.filter(u=>a.includes(u))}m(er,"intersection");function tr(e,a){return e.filter(u=>!a.includes(u))}m(tr,"difference");function rr(e,a){return Array.from(new Set([...e,...a]))}m(rr,"union");function nr(e){return[...new Set(e)]}m(nr,"deduplicate");function ir(e,a){const u=e==null?void 0:e.indexOf(a);return u>=0?(e.splice(u,1),true):false}m(ir,"remove");function ar(e){return Array.isArray(e)?e:j(e)?[]:[e]}m(ar,"makeArray");function q(e,a){return arguments.length===1?u=>q(e,u):e in globalThis&&a instanceof globalThis[e]||Object.prototype.toString.call(a).slice(8,-1)===e}m(q,"is");function G(e){return q("ArrayBuffer",e)||q("SharedArrayBuffer",e)}m(G,"isArrayBufferLike");function ft(e){return G(e)||ArrayBuffer.isView(e)}m(ft,"isArrayBufferSource");var H;(e=>{e.is=G,e.isSource=ft;function a(o){return ArrayBuffer.isView(o)?o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength):o}e.fromSource=a,m(a,"fromSource");function u(o){if(typeof Buffer<"u")return Buffer.from(o).toString("base64");let f="";const t=new Uint8Array(o);for(let i=0;i<t.byteLength;i++)f+=String.fromCharCode(t[i]);return btoa(f)}e.toBase64=u,m(u,"toBase64");function c(o){return typeof Buffer<"u"?a(Buffer.from(o,"base64")):Uint8Array.from(atob(o),f=>f.charCodeAt(0))}e.fromBase64=c,m(c,"fromBase64");function y(o){return typeof Buffer<"u"?Buffer.from(o).toString("hex"):Array.from(new Uint8Array(o),f=>f.toString(16).padStart(2,"0")).join("")}e.toHex=y,m(y,"toHex");function d(o){if(typeof Buffer<"u")return a(Buffer.from(o,"hex"));const f=o.length%2===0?o:o.slice(0,o.length-1),t=[];for(let i=0;i<f.length;i+=2)t.push(parseInt(`${f[i]}${f[i+1]}`,16));return Uint8Array.from(t).buffer}e.fromHex=d,m(d,"fromHex")})(H||(H={}));H.fromBase64;H.toBase64;H.fromHex;H.toHex;function we(e){return!e||typeof e!="object"?e:Array.isArray(e)?e.map(we):q("Date",e)?new Date(e.valueOf()):q("RegExp",e)?new RegExp(e.source,e.flags):G(e)?e.slice(0):ArrayBuffer.isView(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):lt(e,we)}m(we,"clone");function xe(e,a,u){if(e===a||!u&&j(e)&&j(a))return true;if(typeof e!=typeof a||typeof e!="object"||!e||!a)return false;function c(y,d){return y(e)?y(a)?d(e,a):false:y(a)?false:void 0}return m(c,"check"),c(Array.isArray,(y,d)=>y.length===d.length&&y.every((o,f)=>xe(o,d[f])))??c(q("Date"),(y,d)=>y.valueOf()===d.valueOf())??c(q("RegExp"),(y,d)=>y.source===d.source&&y.flags===d.flags)??c(G,(y,d)=>{if(y.byteLength!==d.byteLength)return false;const o=new Uint8Array(y),f=new Uint8Array(d);for(let t=0;t<o.length;t++)if(o[t]!==f[t])return false;return true})??Object.keys({...e,...a}).every(y=>xe(e[y],a[y],u))}m(xe,"deepEqual");function or(e){return e.charAt(0).toUpperCase()+e.slice(1)}m(or,"capitalize");function Ce(e){return e.charAt(0).toLowerCase()+e.slice(1)}m(Ce,"uncapitalize");function sr(e){return e.replace(/[_-][a-z]/g,a=>a.slice(1).toUpperCase())}m(sr,"camelCase");function lr(e){return Ce(e).replace(/_/g,"-").replace(/.[A-Z]+/g,a=>a[0]+"-"+a.slice(1).toLowerCase())}m(lr,"paramCase");function fr(e){return Ce(e).replace(/-/g,"_").replace(/.[A-Z]+/g,a=>a[0]+"_"+a.slice(1).toLowerCase())}m(fr,"snakeCase");function ut(e){return e.replace(/\/$/,"")}m(ut,"trimSlash");function ur(e){return e.startsWith("/")||(e="/"+e),ut(e)}m(ur,"sanitize");var ee;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let a=new Date().getTimezoneOffset();function u(p){a=p}e.setTimezoneOffset=u,m(u,"setTimezoneOffset");function c(){return a}e.getTimezoneOffset=c,m(c,"getTimezoneOffset");function y(p=new Date,g){return typeof p=="number"&&(p=new Date(p)),g===void 0&&(g=a),Math.floor((p.valueOf()/e.minute-g)/1440)}e.getDateNumber=y,m(y,"getDateNumber");function d(p,g){const S=new Date(p*e.day);return g===void 0&&(g=a),new Date(+S+g*e.minute)}e.fromDateNumber=d,m(d,"fromDateNumber");const o=/\d+(?:\.\d+)?/.source,f=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(p=>`(${o}${p})?`).join("")}$`);function t(p){const g=f.exec(p);return g?(parseFloat(g[1])*e.week||0)+(parseFloat(g[2])*e.day||0)+(parseFloat(g[3])*e.hour||0)+(parseFloat(g[4])*e.minute||0)+(parseFloat(g[5])*e.second||0):0}e.parseTime=t,m(t,"parseTime");function i(p){const g=t(p);return g?p=Date.now()+g:/^\d{1,2}(:\d{1,2}){1,2}$/.test(p)?p=`${new Date().toLocaleDateString()}-${p}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(p)&&(p=`${new Date().getFullYear()}-${p}`),p?new Date(p):new Date}e.parseDate=i,m(i,"parseDate");function s(p){const g=Math.abs(p);return g>=e.day-e.hour/2?Math.round(p/e.day)+"d":g>=e.hour-e.minute/2?Math.round(p/e.hour)+"h":g>=e.minute-e.second/2?Math.round(p/e.minute)+"m":g>=e.second?Math.round(p/e.second)+"s":p+"ms"}e.format=s,m(s,"format");function l(p,g=2){return p.toString().padStart(g,"0")}e.toDigits=l,m(l,"toDigits");function h(p,g=new Date){return p.replace("yyyy",g.getFullYear().toString()).replace("yy",g.getFullYear().toString().slice(2)).replace("MM",l(g.getMonth()+1)).replace("dd",l(g.getDate())).replace("hh",l(g.getHours())).replace("mm",l(g.getMinutes())).replace("ss",l(g.getSeconds())).replace("SSS",l(g.getMilliseconds(),3))}e.template=h,m(h,"template")})(ee||(ee={}));const cr={},pr=Object.freeze(Object.defineProperty({__proto__:null,default:cr},Symbol.toStringTag,{value:"Module"})),hr=Vt(pr);var me,et;function gr(){if(et)return me;et=1;var e=typeof Map=="function"&&Map.prototype,a=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,u=e&&a&&typeof a.get=="function"?a.get:null,c=e&&Map.prototype.forEach,y=typeof Set=="function"&&Set.prototype,d=Object.getOwnPropertyDescriptor&&y?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=y&&d&&typeof d.get=="function"?d.get:null,f=y&&Set.prototype.forEach,t=typeof WeakMap=="function"&&WeakMap.prototype,i=t?WeakMap.prototype.has:null,s=typeof WeakSet=="function"&&WeakSet.prototype,l=s?WeakSet.prototype.has:null,h=typeof WeakRef=="function"&&WeakRef.prototype,p=h?WeakRef.prototype.deref:null,g=Boolean.prototype.valueOf,S=Object.prototype.toString,C=Function.prototype.toString,L=String.prototype.match,k=String.prototype.slice,A=String.prototype.replace,te=String.prototype.toUpperCase,Be=String.prototype.toLowerCase,Le=RegExp.prototype.test,Me=Array.prototype.concat,M=Array.prototype.join,gt=Array.prototype.slice,$e=Math.floor,re=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ne=Object.getOwnPropertySymbols,ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,U=typeof Symbol=="function"&&typeof Symbol.iterator=="object",x=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===U||true)?Symbol.toStringTag:null,Ie=Object.prototype.propertyIsEnumerable,De=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function Re(r,n){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||Le.call(/e/,n))return n;var v=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var b=r<0?-$e(-r):$e(r);if(b!==r){var w=String(b),_=k.call(n,w.length+1);return A.call(w,v,"$&_")+"."+A.call(A.call(_,/([0-9]{3})/g,"$&_"),/_$/,"")}}return A.call(n,v,"$&_")}var ae=hr,Ne=ae.custom,qe=Pe(Ne)?Ne:null;me=function r(n,v,b,w){var _=v||{};if(I(_,"quoteStyle")&&_.quoteStyle!=="single"&&_.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(I(_,"maxStringLength")&&(typeof _.maxStringLength=="number"?_.maxStringLength<0&&_.maxStringLength!==1/0:_.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var R=I(_,"customInspect")?_.customInspect:true;if(typeof R!="boolean"&&R!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(I(_,"indent")&&_.indent!==null&&_.indent!=="	"&&!(parseInt(_.indent,10)===_.indent&&_.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(I(_,"numericSeparator")&&typeof _.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var z=_.numericSeparator;if(typeof n>"u")return"undefined";if(n===null)return"null";if(typeof n=="boolean")return n?"true":"false";if(typeof n=="string")return He(n,_);if(typeof n=="number"){if(n===0)return 1/0/n>0?"0":"-0";var O=String(n);return z?Re(n,O):O}if(typeof n=="bigint"){var N=String(n)+"n";return z?Re(n,N):N}var fe=typeof _.depth>"u"?5:_.depth;if(typeof b>"u"&&(b=0),b>=fe&&fe>0&&typeof n=="object")return oe(n)?"[Array]":"[Object]";var P=$t(_,b);if(typeof w>"u")w=[];else if(We(w,n)>=0)return"[Circular]";function B(W,Z,Dt){if(Z&&(w=gt.call(w),w.push(Z)),Dt){var Qe={depth:_.depth};return I(_,"quoteStyle")&&(Qe.quoteStyle=_.quoteStyle),r(W,Qe,b+1,w)}return r(W,_,b+1,w)}if(typeof n=="function"&&!Ue(n)){var Ve=xt(n),Te=J(n,B);return"[Function"+(Ve?": "+Ve:" (anonymous)")+"]"+(Te.length>0?" { "+M.call(Te,", ")+" }":"")}if(Pe(n)){var Ge=U?A.call(String(n),/^(Symbol\(.*\))_[^)]*$/,"$1"):ie.call(n);return typeof n=="object"&&!U?F(Ge):Ge}if(Bt(n)){for(var V="<"+Be.call(String(n.nodeName)),ue=n.attributes||[],Y=0;Y<ue.length;Y++)V+=" "+ue[Y].name+"="+ze(yt(ue[Y].value),"double",_);return V+=">",n.childNodes&&n.childNodes.length&&(V+="..."),V+="</"+Be.call(String(n.nodeName))+">",V}if(oe(n)){if(n.length===0)return"[]";var ce=J(n,B);return P&&!Mt(ce)?"["+le(ce,P)+"]":"[ "+M.call(ce,", ")+" ]"}if(mt(n)){var pe=J(n,B);return!("cause"in Error.prototype)&&"cause"in n&&!Ie.call(n,"cause")?"{ ["+String(n)+"] "+M.call(Me.call("[cause]: "+B(n.cause),pe),", ")+" }":pe.length===0?"["+String(n)+"]":"{ ["+String(n)+"] "+M.call(pe,", ")+" }"}if(typeof n=="object"&&R){if(qe&&typeof n[qe]=="function"&&ae)return ae(n,{depth:fe-b});if(R!=="symbol"&&typeof n.inspect=="function")return n.inspect()}if(Ot(n)){var Je=[];return c&&c.call(n,function(W,Z){Je.push(B(Z,n,true)+" => "+B(W,n))}),Fe("Map",u.call(n),Je,P)}if(kt(n)){var Ye=[];return f&&f.call(n,function(W){Ye.push(B(W,n))}),Fe("Set",o.call(n),Ye,P)}if(Et(n))return se("WeakMap");if(At(n))return se("WeakSet");if(Ct(n))return se("WeakRef");if(vt(n))return F(B(Number(n)));if(St(n))return F(B(re.call(n)));if(bt(n))return F(g.call(n));if(_t(n))return F(B(String(n)));if(typeof window<"u"&&n===window)return"{ [object Window] }";if(n===ot)return"{ [object globalThis] }";if(!dt(n)&&!Ue(n)){var he=J(n,B),Ze=De?De(n)===Object.prototype:n instanceof Object||n.constructor===Object,ge=n instanceof Object?"":"null prototype",Xe=!Ze&&x&&Object(n)===n&&x in n?k.call(D(n),8,-1):ge?"Object":"",It=Ze||typeof n.constructor!="function"?"":n.constructor.name?n.constructor.name+" ":"",ye=It+(Xe||ge?"["+M.call(Me.call([],Xe||[],ge||[]),": ")+"] ":"");return he.length===0?ye+"{}":P?ye+"{"+le(he,P)+"}":ye+"{ "+M.call(he,", ")+" }"}return String(n)};function ze(r,n,v){var b=(v.quoteStyle||n)==="double"?'"':"'";return b+r+b}function yt(r){return A.call(String(r),/"/g,"&quot;")}function oe(r){return D(r)==="[object Array]"&&(!x||!(typeof r=="object"&&x in r))}function dt(r){return D(r)==="[object Date]"&&(!x||!(typeof r=="object"&&x in r))}function Ue(r){return D(r)==="[object RegExp]"&&(!x||!(typeof r=="object"&&x in r))}function mt(r){return D(r)==="[object Error]"&&(!x||!(typeof r=="object"&&x in r))}function _t(r){return D(r)==="[object String]"&&(!x||!(typeof r=="object"&&x in r))}function vt(r){return D(r)==="[object Number]"&&(!x||!(typeof r=="object"&&x in r))}function bt(r){return D(r)==="[object Boolean]"&&(!x||!(typeof r=="object"&&x in r))}function Pe(r){if(U)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return true;if(!r||typeof r!="object"||!ie)return false;try{return ie.call(r),true}catch{}return false}function St(r){if(!r||typeof r!="object"||!re)return false;try{return re.call(r),true}catch{}return false}var wt=Object.prototype.hasOwnProperty||function(r){return r in this};function I(r,n){return wt.call(r,n)}function D(r){return S.call(r)}function xt(r){if(r.name)return r.name;var n=L.call(C.call(r),/^function\s*([\w$]+)/);return n?n[1]:null}function We(r,n){if(r.indexOf)return r.indexOf(n);for(var v=0,b=r.length;v<b;v++)if(r[v]===n)return v;return-1}function Ot(r){if(!u||!r||typeof r!="object")return false;try{u.call(r);try{o.call(r)}catch{return true}return r instanceof Map}catch{}return false}function Et(r){if(!i||!r||typeof r!="object")return false;try{i.call(r,i);try{l.call(r,l)}catch{return true}return r instanceof WeakMap}catch{}return false}function Ct(r){if(!p||!r||typeof r!="object")return false;try{return p.call(r),true}catch{}return false}function kt(r){if(!o||!r||typeof r!="object")return false;try{o.call(r);try{u.call(r)}catch{return true}return r instanceof Set}catch{}return false}function At(r){if(!l||!r||typeof r!="object")return false;try{l.call(r,l);try{i.call(r,i)}catch{return true}return r instanceof WeakSet}catch{}return false}function Bt(r){return!r||typeof r!="object"?false:typeof HTMLElement<"u"&&r instanceof HTMLElement?true:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function He(r,n){if(r.length>n.maxStringLength){var v=r.length-n.maxStringLength,b="... "+v+" more character"+(v>1?"s":"");return He(k.call(r,0,n.maxStringLength),n)+b}var w=A.call(A.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Lt);return ze(w,"single",n)}function Lt(r){var n=r.charCodeAt(0),v={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];return v?"\\"+v:"\\x"+(n<16?"0":"")+te.call(n.toString(16))}function F(r){return"Object("+r+")"}function se(r){return r+" { ? }"}function Fe(r,n,v,b){var w=b?le(v,b):M.call(v,", ");return r+" ("+n+") {"+w+"}"}function Mt(r){for(var n=0;n<r.length;n++)if(We(r[n],`
`)>=0)return false;return true}function $t(r,n){var v;if(r.indent==="	")v="	";else if(typeof r.indent=="number"&&r.indent>0)v=M.call(Array(r.indent+1)," ");else return null;return{base:v,prev:M.call(Array(n+1),v)}}function le(r,n){if(r.length===0)return"";var v=`
`+n.prev+n.base;return v+M.call(r,","+v)+`
`+n.prev}function J(r,n){var v=oe(r),b=[];if(v){b.length=r.length;for(var w=0;w<r.length;w++)b[w]=I(r,w)?n(r[w],r):""}var _=typeof ne=="function"?ne(r):[],R;if(U){R={};for(var z=0;z<_.length;z++)R["$"+_[z]]=_[z]}for(var O in r)I(r,O)&&(v&&String(Number(O))===O&&O<r.length||U&&R["$"+O]instanceof Symbol||(Le.call(/[^\w$]/,O)?b.push(n(O,r)+": "+n(r[O],r)):b.push(O+": "+n(r[O],r))));if(typeof ne=="function")for(var N=0;N<_.length;N++)Ie.call(r,_[N])&&b.push("["+n(_[N])+"]: "+n(r[_[N]],r));return b}return me}var yr=gr();const dr=st(yr);var mr=Object.create,ke=Object.defineProperty,_r=Object.getOwnPropertyDescriptor,ct=Object.getOwnPropertyNames,vr=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty,X=(e,a)=>ke(e,"name",{value:a,configurable:true}),pt=(e,a)=>function(){return a||(0,e[ct(e)[0]])((a={exports:{}}).exports,a),a.exports},Sr=(e,a,u,c)=>{if(a&&typeof a=="object"||typeof a=="function")for(let y of ct(a))!br.call(e,y)&&y!==u&&ke(e,y,{get:()=>a[y],enumerable:!(c=_r(a,y))||c.enumerable});return e},wr=(e,a,u)=>(u=e!=null?mr(vr(e)):{},Sr(!e||!e.__esModule?ke(u,"default",{value:e,enumerable:true}):u,e)),xr=pt({"src/shared.ts"(e,a){var o;var u=[6,2,3,4,5,1],c=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221];function y(f){return f instanceof Error&&Array.isArray(f.errors)}X(y,"isAggregateError");var d=(o=class{constructor(t,i){E(this,"extend",X(t2=>new o(`${this.name}:${t2}`,this.meta),"extend"));E(this,"warning",X((t2,...i2)=>{this.warn(t2,...i2)},"warning"));this.name=t,this.meta=i,this.createMethod("success",o.SUCCESS),this.createMethod("error",o.ERROR),this.createMethod("info",o.INFO),this.createMethod("warn",o.WARN),this.createMethod("debug",o.DEBUG)}static format(t,i){this.formatters[t]=i}static color(t,i,s,l=""){return t.colors?`\x1B[3${i<8?i:"8;5;"+i}${t.colors>=2?l:""}m${s}\x1B[0m`:""+s}static code(t,i){let s=0;for(let h=0;h<t.length;h++)s=(s<<3)-s+t.charCodeAt(h)+13,s|=0;const l=i.colors?i.colors>=2?c:u:[];return l[Math.abs(s)%l.length]}static render(t,i){var L,k,A;const s=`[${i.type[0].toUpperCase()}]`,l=" ".repeat(((L=t.label)==null?void 0:L.margin)??1);let h=3+l.length,p="";t.showTime&&(h+=t.showTime.length+l.length,p+=o.color(t,8,ee.template(t.showTime))+l);const g=o.code(i.name,t),S=o.color(t,g,i.name,";1"),C=(((k=t.label)==null?void 0:k.width)??0)+S.length-i.name.length;if(((A=t.label)==null?void 0:A.align)==="right"?(p+=S.padStart(C)+l+s+l,h+=(t.label.width??0)+l.length):p+=s+l+S.padEnd(C)+l,p+=i.content.replace(/\n/g,`
`+" ".repeat(h)),t.showDiff&&t.timestamp){const te=i.timestamp-t.timestamp;p+=o.color(t,g," +"+ee.format(te))}return p}createMethod(t,i){this[t]=(...s)=>{if(s.length===1&&s[0]instanceof Error){if(s[0].cause)this[t](s[0].cause);else if(y(s[0])){s[0].errors.forEach(p=>this[t](p));return}}const l=++o.id,h=Date.now();for(const p of o.targets){if(this.getLevel(p)<i)continue;const g=this.format(p,...s),S={id:l,type:t,level:i,name:this.name,meta:this.meta,content:g,timestamp:h};if(p.record)p.record(S);else{const{print:C=console.log}=p;C(o.render(p,S))}p.timestamp=h}}}format(t,...i){i[0]instanceof Error?(i[0]=i[0].stack||i[0].message,i.unshift("%s")):typeof i[0]!="string"&&i.unshift("%o");let s=i.shift();s=s.replace(/%([a-zA-Z%])/g,(h,p)=>{if(h==="%%")return"%";const g=o.formatters[p];if(typeof g=="function"){const S=i.shift();return g(S,t,this)}return h});for(let h of i)typeof h=="object"&&h&&(h=o.formatters.o(h,t,this)),s+=" "+h;const{maxLength:l=10240}=t;return s.split(/\r?\n/g).map(h=>h.slice(0,l)+(h.length>l?"...":"")).join(`
`)}getLevel(t){const i=this.name.split(":");let s=(t==null?void 0:t.levels)||o.levels;do s=s[i.shift()]??s.base;while(i.length&&typeof s=="object");return s}get level(){return this.getLevel()}set level(t){const i=this.name.split(":");let s=o.levels;for(;i.length>1;){const l=i.shift(),h=s[l];typeof h=="object"?s=h:s=s[l]={base:h??s.base}}s[i[0]]=t}},X(o,"Logger"),E(o,"SILENT",0),E(o,"SUCCESS",1),E(o,"ERROR",1),E(o,"INFO",2),E(o,"WARN",2),E(o,"DEBUG",3),E(o,"id",0),E(o,"targets",[{colors:je.stdout&&je.stdout.level,print(t){console.log(t)}}]),E(o,"formatters",Object.create(null)),E(o,"levels",{base:2}),o);d.format("s",f=>f),d.format("d",f=>+f),d.format("j",f=>JSON.stringify(f)),d.format("c",(f,t,i)=>d.color(t,d.code(i.name,t),f)),d.format("C",(f,t)=>d.color(t,15,f,";1")),a.exports=d}}),Or=pt({"src/browser.ts"(e,a){var u=wr(xr());u.default.format("o",(c,y)=>dr(c,{depth:1/0}).replace(/\s*\n\s*/g," ")),a.exports=u.default}});const Er=Or();var _e={},tt;function Cr(){return tt||(tt=1,function(e){(function(a,u){if(typeof e.nodeName!="string")u(e);else{var c={};u(c),a.AnsiUp=c.default}})(ot,function(a){var u=this&&this.__makeTemplateObject||function(f,t){return Object.defineProperty?Object.defineProperty(f,"raw",{value:t}):f.raw=t,f},c;(function(f){f[f.EOS=0]="EOS",f[f.Text=1]="Text",f[f.Incomplete=2]="Incomplete",f[f.ESC=3]="ESC",f[f.Unknown=4]="Unknown",f[f.SGR=5]="SGR",f[f.OSCURL=6]="OSCURL"})(c||(c={}));var y=function(){function f(){this.VERSION="5.2.1",this.setup_palettes(),this._use_classes=false,this.bold=false,this.italic=false,this.underline=false,this.fg=this.bg=null,this._buffer="",this._url_whitelist={http:1,https:1},this._escape_html=true}return Object.defineProperty(f.prototype,"use_classes",{get:function(){return this._use_classes},set:function(t){this._use_classes=t},enumerable:false,configurable:true}),Object.defineProperty(f.prototype,"url_whitelist",{get:function(){return this._url_whitelist},set:function(t){this._url_whitelist=t},enumerable:false,configurable:true}),Object.defineProperty(f.prototype,"escape_html",{get:function(){return this._escape_html},set:function(t){this._escape_html=t},enumerable:false,configurable:true}),f.prototype.setup_palettes=function(){var t=this;this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.palette_256=[],this.ansi_colors.forEach(function(L){L.forEach(function(k){t.palette_256.push(k)})});for(var i=[0,95,135,175,215,255],s=0;s<6;++s)for(var l=0;l<6;++l)for(var h=0;h<6;++h){var p={rgb:[i[s],i[l],i[h]],class_name:"truecolor"};this.palette_256.push(p)}for(var g=8,S=0;S<24;++S,g+=10){var C={rgb:[g,g,g],class_name:"truecolor"};this.palette_256.push(C)}},f.prototype.escape_txt_for_html=function(t){return this._escape_html?t.replace(/[&<>"']/gm,function(i){if(i==="&")return"&amp;";if(i==="<")return"&lt;";if(i===">")return"&gt;";if(i==='"')return"&quot;";if(i==="'")return"&#x27;"}):t},f.prototype.append_buffer=function(t){var i=this._buffer+t;this._buffer=i},f.prototype.get_next_packet=function(){var t={kind:c.EOS,text:"",url:""},i=this._buffer.length;if(i==0)return t;var s=this._buffer.indexOf("\x1B");if(s==-1)return t.kind=c.Text,t.text=this._buffer,this._buffer="",t;if(s>0)return t.kind=c.Text,t.text=this._buffer.slice(0,s),this._buffer=this._buffer.slice(s),t;if(s==0){if(i<3)return t.kind=c.Incomplete,t;var l=this._buffer.charAt(1);if(l!="["&&l!="]"&&l!="(")return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;if(l=="["){this._csi_regex||(this._csi_regex=d(u([`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \x1B[                      # CSI
                          ([<-?]?)              # private-mode char
                          ([d;]*)                    # any digits or semicolons
                          ([ -/]?               # an intermediate modifier
                          [@-~])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \x1B[                      # CSI
                          [ -~]*                # anything legal
                          ([\0-:])              # anything illegal
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \\x1b\\[                      # CSI
                          ([\\x3c-\\x3f]?)              # private-mode char
                          ([\\d;]*)                    # any digits or semicolons
                          ([\\x20-\\x2f]?               # an intermediate modifier
                          [\\x40-\\x7e])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \\x1b\\[                      # CSI
                          [\\x20-\\x7e]*                # anything legal
                          ([\\x00-\\x1f:])              # anything illegal
                        )
                    `])));var h=this._buffer.match(this._csi_regex);if(h===null)return t.kind=c.Incomplete,t;if(h[4])return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;h[1]!=""||h[3]!="m"?t.kind=c.Unknown:t.kind=c.SGR,t.text=h[2];var p=h[0].length;return this._buffer=this._buffer.slice(p),t}else if(l=="]"){if(i<4)return t.kind=c.Incomplete,t;if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";")return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;this._osc_st||(this._osc_st=o(u([`
                        (?:                         # legal sequence
                          (\x1B\\)                    # ESC                           |                           # alternate
                          (\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\0-]                 # anything illegal
                          |                           # alternate
                          [\b-]                 # anything illegal
                          |                           # alternate
                          [-]                 # anything illegal
                        )
                    `],[`
                        (?:                         # legal sequence
                          (\\x1b\\\\)                    # ESC \\
                          |                           # alternate
                          (\\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\\x00-\\x06]                 # anything illegal
                          |                           # alternate
                          [\\x08-\\x1a]                 # anything illegal
                          |                           # alternate
                          [\\x1c-\\x1f]                 # anything illegal
                        )
                    `]))),this._osc_st.lastIndex=0;{var g=this._osc_st.exec(this._buffer);if(g===null)return t.kind=c.Incomplete,t;if(g[3])return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t}{var S=this._osc_st.exec(this._buffer);if(S===null)return t.kind=c.Incomplete,t;if(S[3])return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t}this._osc_regex||(this._osc_regex=d(u([`
                        ^                           # beginning of line
                                                    #
                        \x1B]8;                    # OSC Hyperlink
                        [ -:<-~]*       # params (excluding ;)
                        ;                           # end of params
                        ([!-~]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                        ([ -~]+)              # TEXT capture
                        \x1B]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                        \\x1b\\]8;                    # OSC Hyperlink
                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)
                        ;                           # end of params
                        ([\\x21-\\x7e]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                        ([\\x20-\\x7e]+)              # TEXT capture
                        \\x1b\\]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                    `])));var h=this._buffer.match(this._osc_regex);if(h===null)return t.kind=c.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;t.kind=c.OSCURL,t.url=h[1],t.text=h[2];var p=h[0].length;return this._buffer=this._buffer.slice(p),t}else if(l=="(")return t.kind=c.Unknown,this._buffer=this._buffer.slice(3),t}},f.prototype.ansi_to_html=function(t){this.append_buffer(t);for(var i=[];;){var s=this.get_next_packet();if(s.kind==c.EOS||s.kind==c.Incomplete)break;s.kind==c.ESC||s.kind==c.Unknown||(s.kind==c.Text?i.push(this.transform_to_html(this.with_state(s))):s.kind==c.SGR?this.process_ansi(s):s.kind==c.OSCURL&&i.push(this.process_hyperlink(s)))}return i.join("")},f.prototype.with_state=function(t){return{bold:this.bold,italic:this.italic,underline:this.underline,fg:this.fg,bg:this.bg,text:t.text}},f.prototype.process_ansi=function(t){for(var i=t.text.split(";");i.length>0;){var s=i.shift(),l=parseInt(s,10);if(isNaN(l)||l===0)this.fg=this.bg=null,this.bold=false,this.italic=false,this.underline=false;else if(l===1)this.bold=true;else if(l===3)this.italic=true;else if(l===4)this.underline=true;else if(l===22)this.bold=false;else if(l===23)this.italic=false;else if(l===24)this.underline=false;else if(l===39)this.fg=null;else if(l===49)this.bg=null;else if(l>=30&&l<38)this.fg=this.ansi_colors[0][l-30];else if(l>=40&&l<48)this.bg=this.ansi_colors[0][l-40];else if(l>=90&&l<98)this.fg=this.ansi_colors[1][l-90];else if(l>=100&&l<108)this.bg=this.ansi_colors[1][l-100];else if((l===38||l===48)&&i.length>0){var h=l===38,p=i.shift();if(p==="5"&&i.length>0){var g=parseInt(i.shift(),10);g>=0&&g<=255&&(h?this.fg=this.palette_256[g]:this.bg=this.palette_256[g])}if(p==="2"&&i.length>2){var S=parseInt(i.shift(),10),C=parseInt(i.shift(),10),L=parseInt(i.shift(),10);if(S>=0&&S<=255&&C>=0&&C<=255&&L>=0&&L<=255){var k={rgb:[S,C,L],class_name:"truecolor"};h?this.fg=k:this.bg=k}}}}},f.prototype.transform_to_html=function(t){var i=t.text;if(i.length===0||(i=this.escape_txt_for_html(i),!t.bold&&!t.italic&&!t.underline&&t.fg===null&&t.bg===null))return i;var s=[],l=[],h=t.fg,p=t.bg;t.bold&&s.push("font-weight:bold"),t.italic&&s.push("font-style:italic"),t.underline&&s.push("text-decoration:underline"),this._use_classes?(h&&(h.class_name!=="truecolor"?l.push(h.class_name+"-fg"):s.push("color:rgb("+h.rgb.join(",")+")")),p&&(p.class_name!=="truecolor"?l.push(p.class_name+"-bg"):s.push("background-color:rgb("+p.rgb.join(",")+")"))):(h&&s.push("color:rgb("+h.rgb.join(",")+")"),p&&s.push("background-color:rgb("+p.rgb+")"));var g="",S="";return l.length&&(g=' class="'+l.join(" ")+'"'),s.length&&(S=' style="'+s.join(";")+'"'),"<span"+S+g+">"+i+"</span>"},f.prototype.process_hyperlink=function(t){var i=t.url.split(":");if(i.length<1||!this._url_whitelist[i[0]])return"";var s='<a href="'+this.escape_txt_for_html(t.url)+'">'+this.escape_txt_for_html(t.text)+"</a>";return s},f}();function d(f){var t=f.raw[0],i=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,s=t.replace(i,"");return new RegExp(s)}function o(f){var t=f.raw[0],i=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,s=t.replace(i,"");return new RegExp(s,"g")}Object.defineProperty(a,"__esModule",{value:true}),a.default=y})}(_e)),_e}var kr=Cr();const rt=st(kr),Ar=["innerHTML"],nt="yyyy-MM-dd hh:mm:ss",Br=Oe({__name:"logs",props:{logs:{},showLink:{type:Boolean},maxHeight:{}},setup(e){const a=e,u=new(rt.default||rt);function c(o,f,t=""){return`\x1B[3${o<8?o:"8;5;"+o}${t}m${f}\x1B[0m`}function y(o){return o.index&&a.logs[o.index-1].id>o.id&&o.name==="app"}function d(o){const f=`[${o.type[0].toUpperCase()}]`,t=" ";let i=3+t.length,s="";i+=nt.length+t.length,s+=c(8,Ht.template(nt,new Date(o.timestamp)))+t;const l=Er.code(o.name,{colors:3}),h=c(l,o.name,";1"),p=h.length-o.name.length;return s+=f+t+h.padEnd(p)+t,s+=o.content.replace(/\n/g,`
`+" ".repeat(i)),u.ansi_to_html(s)}return(o,f)=>{const t=ve("k-icon"),i=ve("router-link");return T(),be(Q(Wt),{class:"log-list k-text-selectable",data:o.logs,count:300,"max-height":o.maxHeight},{default:Se(s=>{var l,h;return[K("div",{class:qt({line:true,start:y(s)})},[K("code",{innerHTML:d(s)},null,8,Ar),o.showLink&&Q($).config&&Q($).packages&&((h=(l=s.meta)==null?void 0:l.paths)!=null&&h.length)?(T(),be(i,{key:0,class:"log-link inline-flex items-center justify-center absolute w-20px h-20px bottom-0 right-0",to:"/plugins/"+s.meta.paths[0].replace(/\./,"/")},{default:Se(()=>[Ee(t,{name:"arrow-right"})]),_:2},1032,["to"])):it("v-if",true)],2)]}),_:1},8,["data","max-height"])}}}),Ae=(e,a)=>{const u=e.__vccOpts||e;for(const[c,y]of a)u[c]=y;return u},ht=Ae(Br,[["__scopeId","data-v-f399e7fe"]]),Lr=Oe({__name:"index",setup(e){return(a,u)=>{const c=ve("k-layout");return T(),be(c,null,{default:Se(()=>[Ee(ht,{class:"layout-logger",logs:Q($).logs,"show-link":""},null,8,["logs"])]),_:1})}}}),Mr=Oe({__name:"settings",setup(e){const a=zt("manager.settings.current"),u=Ut(()=>{var d,o;if(!$.logs)return[];const c=[];let y=1/0;for(let f=$.logs.length-1;f>0&&!($.logs[f].id>=y);--f)y=$.logs[f].id,(o=(d=$.logs[f].meta)==null?void 0:d.paths)!=null&&o.includes(a.value.path)&&c.unshift($.logs[f]);return c});return(c,y)=>{var d;return(d=u.value)!=null&&d.length?(T(),at(Pt,{key:0},[y[0]||(y[0]=K("h2",{class:"k-schema-header"}," 运行日志 ",-1)),Ee(ht,{class:"settings-logger",logs:u.value,"max-height":"216px"},null,8,["logs"])],64)):it("v-if",true)}}}),$r=Ae(Mr,[["__scopeId","data-v-af449902"]]),Ir={},Dr={class:"k-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"};function Rr(e,a){return T(),at("svg",Dr,a[0]||(a[0]=[K("path",{fill:"currentColor",d:"M304 336h-128C167.2 336 160 343.2 160 352s7.156 16 16 16h128c8.844 0 16-7.156 16-16S312.8 336 304 336zM304 240h-96C199.2 240 192 247.2 192 256s7.156 16 16 16h96C312.8 272 320 264.8 320 256S312.8 240 304 240zM96 328c-13.25 0-24 10.74-24 24c0 13.25 10.75 24 24 24c13.26 0 24-10.75 24-24C120 338.7 109.3 328 96 328zM320 64c-8.844 0-16 7.156-16 16S311.2 96 320 96c17.64 0 32 14.34 32 32v320c0 17.66-14.36 32-32 32H64c-17.64 0-32-14.34-32-32V128c0-17.66 14.36-32 32-32c8.844 0 16-7.156 16-16S72.84 64 64 64C28.7 64 0 92.72 0 128v320c0 35.28 28.7 64 64 64h256c35.3 0 64-28.72 64-64V128C384 92.72 355.3 64 320 64zM112 128h160C280.8 128 288 120.8 288 112S280.8 96 272 96h-24.88C252.6 86.55 256 75.72 256 64c0-35.35-28.65-64-64-64S128 28.65 128 64c0 11.72 3.379 22.55 8.877 32H112C103.2 96 96 103.2 96 112S103.2 128 112 128zM192 32c17.64 0 32 14.36 32 32s-14.36 32-32 32S160 81.64 160 64S174.4 32 192 32zM68.25 229.2c-6 6.5-5.594 16.59 .9062 22.59l34.66 32C106.9 286.6 110.8 288 114.7 288c4.203 0 8.406-1.656 11.55-4.938l61.33-64c6.125-6.375 5.906-16.5-.4844-22.62c-6.359-6.094-16.48-5.906-22.61 .5L113.1 249.6L90.84 228.3C84.39 222.3 74.22 222.6 68.25 229.2z"},null,-1)]))}const Nr=Ae(Ir,[["render",Rr]]);Ft.register("activity:logs",Nr);const Pr=e=>{e.page({path:"/logs",name:"日志",icon:"activity:logs",order:0,authority:4,fields:["logs"],component:Lr}),e.slot({type:"plugin-details",component:$r,order:-800})};export{Pr as default};
