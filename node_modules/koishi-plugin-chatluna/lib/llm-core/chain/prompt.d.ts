import { BaseMessage } from '@langchain/core/messages';
import { BaseChatPromptTemplate, MessagesPlaceholder, SystemMessagePromptTemplate } from '@langchain/core/prompts';
import { ChainValues, PartialValues } from '@langchain/core/utils/types';
import { PresetTemplate } from 'koishi-plugin-chatluna/llm-core/prompt';
import { SystemPrompts } from 'koishi-plugin-chatluna/llm-core/chain/base';
import type { PresetFormatService } from 'koishi-plugin-chatluna/services/chat';
export interface ChatLunaChatPromptInput {
    messagesPlaceholder?: MessagesPlaceholder;
    tokenCounter: (text: string) => Promise<number>;
    sendTokenLimit?: number;
    preset?: () => Promise<PresetTemplate>;
    partialVariables?: PartialValues;
    variableService: PresetFormatService;
}
export interface ChatLunaChatPromptFormat {
    input: BaseMessage;
    chat_history: BaseMessage[] | string;
    variables?: ChainValues;
    agent_scratchpad?: BaseMessage[] | BaseMessage;
    instructions?: string;
}
export declare class ChatLunaChatPrompt extends BaseChatPromptTemplate<ChatLunaChatPromptFormat> implements ChatLunaChatPromptInput {
    getPreset?: () => Promise<PresetTemplate>;
    tokenCounter: (text: string) => Promise<number>;
    conversationSummaryPrompt?: SystemMessagePromptTemplate;
    _tempPreset?: [PresetTemplate, [SystemPrompts, string[]]];
    sendTokenLimit?: number;
    variableService: PresetFormatService;
    partialVariables: PartialValues;
    private _systemPrompts;
    private fields;
    constructor(fields: ChatLunaChatPromptInput);
    _getPromptType(): "chatluna_chat";
    private _countMessageTokens;
    private _formatSystemPrompts;
    formatMessages({ chat_history: chatHistory, input, variables, agent_scratchpad: agentScratchpad, instructions }: ChatLunaChatPromptFormat): Promise<BaseMessage[]>;
    private _formatLoreBooks;
    private _formatWithMessagesPlaceholder;
    private _counterAuthorsNote;
    private _formatAuthorsNote;
    private _findIndex;
    private _formatLongHistory;
    get tempPreset(): PresetTemplate;
    partial<NewPartialVariableName extends string>(values: PartialValues<NewPartialVariableName>): Promise<ChatLunaChatPrompt>;
}
